# üöÄ –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –Ω–∞ VDS

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
Push –≤ master ‚Üí GitHub Actions ‚Üí SSH –Ω–∞ VDS ‚Üí git pull ‚Üí docker-compose up
```

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **python-telegram-bot** ‚Äî Telegram Bot API
- **aiosqlite** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å SQLite
- **aiohttp** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è OpenDota API
- **python-dotenv** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `requirements.txt`.

---

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–¥–∏–Ω —Ä–∞–∑)

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π VDS

–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:
```bash
ssh root@185.232.205.172
```

–í—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—ã:
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏ Docker
curl -fsSL https://get.docker.com | sh

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏ docker-compose
apt install -y docker-compose

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏ git
apt install -y git

# 4. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
mkdir -p /opt/antispam-bot
cd /opt/antispam-bot
git clone https://github.com/–¢–í–û–ô_–Æ–ó–ï–†–ù–ï–ô–ú/–¢–í–û–ô_–†–ï–ü–û.git .

# 5. –°–æ–∑–¥–∞–π .env —Ñ–∞–π–ª
cp .env.example .env
nano .env   # –î–æ–±–∞–≤—å BOT_TOKEN=—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω

# 6. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
docker-compose up -d

# 7. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
docker-compose logs -f
```

---

## üéÆ Dota 2 —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è Dota 2 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/link <id>` | –ü—Ä–∏–≤—è–∑–∞—Ç—å Steam (Friend ID, Steam ID 64, —Å—Å—ã–ª–∫–∏) |
| `/unlink` | –û—Ç–≤—è–∑–∞—Ç—å Steam –∞–∫–∫–∞—É–Ω—Ç |
| `/game` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∏–≥—Ä–µ –ª–∏ (–æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äî –¥—Ä—É–≥–æ–≥–æ) |
| `/lastgame` | –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–∞ –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –º–∞—Ç—á–µ |
| `/last` | –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (GPM/XPM, —É—Ä–æ–Ω, —Ä–∞–Ω–≥–∏ –≤ –∫–æ–º–∞–Ω–¥–µ) |
| `/profile` | –ü—Ä–æ—Ñ–∏–ª—å —Å —Ä–∞–Ω–≥–æ–º |
| `/toxic` | –ê–Ω–∞–ª–∏–∑ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ (wordcloud –∏–∑ —á–∞—Ç–∞ Dota) |
| `/shame on/off` | –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ "–ø–æ–∑–æ—Ä" –ø–æ—Å–ª–µ –º–∞—Ç—á–µ–π |

### Shame-—Å–µ—Ä–≤–∏—Å
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞—Ç—á–∏ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- –ù–∞—Ö–æ–¥–∏—Ç —Å–∞–º–æ–≥–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —Å—Ä–µ–¥–∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å—Ç–∏—Ç "–ø–æ–∑–æ—Ä" –≤ —á–∞—Ç

### OpenDota API
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π [OpenDota API](https://docs.opendota.com/) –±–µ–∑ –∫–ª—é—á–∞.
–õ–∏–º–∏—Ç—ã: ~60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö —á–∞—Ç–æ–≤).

---

### –®–∞–≥ 2: –î–æ–±–∞–≤—å —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub

1. –û—Ç–∫—Ä–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π–¥–∏: **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
3. –ù–∞–∂–º–∏ **New repository secret**
4. –î–æ–±–∞–≤—å 3 —Å–µ–∫—Ä–µ—Ç–∞:

| Name | Value |
|------|-------|
| `VDS_HOST` | `185.232.205.172` |
| `VDS_USER` | `root` |
| `VDS_PASSWORD` | `—Ç–≤–æ–π_–ø–∞—Ä–æ–ª—å` |

---

### –®–∞–≥ 3: –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø—É—à–µ –≤ `master`:
1. GitHub –∑–∞–ø—É—Å—Ç–∏—Ç workflow
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ VDS –ø–æ SSH
3. –í—ã–ø–æ–ª–Ω–∏—Ç `git pull` –∏ `docker-compose up`

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ VDS

```bash
# –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞
docker-compose ps

# –õ–æ–≥–∏
docker-compose logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –≤—Ä—É—á–Ω—É—é
docker-compose up -d --build
```

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ GitHub Actions
Repository ‚Üí Actions ‚Üí –ü–æ—Å–ª–µ–¥–Ω–∏–π workflow ‚Üí –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏

### –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –Ω–∞ VDS
```bash
cd /opt/antispam-bot
docker-compose logs --tail=50
```

### –ü—Ä–æ–≤–µ—Ä—å .env —Ñ–∞–π–ª
```bash
cat /opt/antispam-bot/.env
```

### –û—à–∏–±–∫–∞ "unable to open database file"

–ï—Å–ª–∏ –±–æ—Ç –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π `sqlite3.OperationalError: unable to open database file`:

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd /opt/antispam-bot
chmod 777 data
touch data/bot.db data/admins.txt
chmod 666 data/bot.db data/admins.txt
docker-compose restart
```

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö —á–µ—Ä–µ–∑:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –≤ `scripts/deploy.sh`
- –ü—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –≤ `docker-entrypoint.sh`
